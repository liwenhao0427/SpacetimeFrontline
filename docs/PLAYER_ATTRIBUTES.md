# 玩家属性设计文档 (v1.0)

## 1. 概述

本文档详细阐述了《超时空防线》中玩家所有可堆叠属性 (`PlayerStats`)。这些属性是玩家通过商店购买道具 (`BrotatoItem`)、英雄升级 (`HeroUpgradeStatus`) 以及战内临时增益获得的。理解这些属性及其相互作用对于玩家的策略构建和未来的平衡性调整至关重要。

## 2. 全局属性概览

所有玩家属性都集中存储在 `PlayerStats` 接口中。它们通过以下方式影响游戏：
*   **直接影响:** 修改单位的伤害、攻速、生命值等。
*   **资源管理:** 影响金币获取、商店价格、经验值获取等。
*   **特殊机制:** 触发独特的战斗效果，如敌人数量变化。

## 3. 属性分类与详情

### 3.1. 资源与进度属性 (Resource & Progression Attributes)

这些属性直接影响玩家的经济和游戏进程。

| 属性名称 | 描述 | 初始值 | 获取/修改方式 |
| :------- | :--- | :---- | :-------------- |
| `gold` (金币) | 用于在商店购买单位、道具或经验值。 | `200` | 击杀敌人、收获 (`harvesting`) 属性、商店出售单位、特殊道具效果。 |
| `heroXp` (英雄经验) | 英雄用于永久升级的经验值。 | `0` | 在商店中花费金币购买。 |
| `heroMaxXp` (英雄最大经验) | 英雄下一次永久升级所需的经验值。 | `50` | 英雄每次升级后，该值会按 `1.5` 倍率递增。 |
| `heroLevel` (英雄等级) | 英雄的永久等级。 | `1` | `heroXp` 达到 `heroMaxXp` 时提升。每次升级会触发“英雄进化”模态框。 |
| `xp` (战内经验) | 战斗中玩家用于临时升级的经验值。 | `0` | 击杀敌人。 |
| `maxXp` (战内最大经验) | 战斗中下一次临时升级所需的经验值。 | `50` | 玩家每次战内升级后，该值会按 `1.5` 倍率递增。 |
| `level` (战内等级) | 玩家的战内等级。 | `1` | `xp` 达到 `maxXp` 时提升。每次升级会触发“战场支援”模态框。 |
| `wave` (当前波数) | 玩家当前正在挑战或已完成的波数。 | `0` | 每波战斗结束或开始时递增。 |
| `lastHarvestYield` (上次收获收益) | 上一波次通过`harvesting`属性获得的金币数量，用于UI展示。 | `null` | 每波次结束时计算。 |
| `harvesting` (收获值) | 每波次结束时自动获得的额外金币数量。 | `0` | 道具 (`BrotatoItem`)。 |
| `xpGain` (经验获取加成) | 击杀敌人时获得的经验值的额外百分比加成。 | `1.0` | 道具 (`BrotatoItem`)。 |
| `shopDiscount` (商店折扣) | 商店中物品价格的百分比减少。 | `0` | 道具 (`BrotatoItem`)。 |

### 3.2. 全局战斗与增益属性 (Global Combat & Buff Attributes)

这些属性是玩家实力提升的核心，大部分通过道具获得，影响所有单位。

| 属性名称 | 描述 | 初始值 | 获取/修改方式 |
| :------- | :--- | :---- | :-------------- |
| `damagePercent` (伤害百分比) | 所有单位造成伤害的额外百分比加成。 | `0` | 道具 (`BrotatoItem`)。 |
| `attackSpeed` (攻击速度百分比) | 所有单位攻击冷却时间的百分比减少（即攻击频率增加）。 | `0` | 道具 (`BrotatoItem`)。 |
| `luck` (幸运值) | 影响商店中高稀有度物品出现的几率。 | `0` | 道具 (`BrotatoItem`)。 |
| `flatHp` (扁平生命值加成) | 所有单位额外获得的固定生命值，会根据单位的 `hpScaling` 系数进行缩放。 | `0` | 道具 (`BrotatoItem`)。 |
| `hpPercent` (生命值百分比加成) | 所有单位额外获得的百分比生命值，会根据单位的 `hpScaling` 系数进行缩放。 | `0` | 道具 (`BrotatoItem`)。 |

### 3.3. 类型伤害加成 (Class Damage Bonuses)

这些属性对特定类型的单位提供扁平伤害加成。

| 属性名称 | 描述 | 初始值 | 获取/修改方式 |
| :------- | :--- | :---- | :-------------- |
| `meleeDmg` (近战伤害加成) | 近战单位基础伤害的扁平加成。 | `0` | 道具 (`BrotatoItem`)。 |
| `rangedDmg` (远程伤害加成) | 远程单位基础伤害的扁平加成。 | `0` | 道具 (`BrotatoItem`)。 |
| `elementalDmg` (元素伤害加成) | 魔法单位基础伤害的扁平加成。 | `0` | 道具 (`BrotatoItem`)。 |
| `engineering` (工程学加成) | 工程单位基础伤害的扁平加成。 | `0` | 道具 (`BrotatoItem`)。 |

### 3.4. 临时属性 (Temporary Attributes - 仅本波次有效)

这些属性在每波战斗开始时重置，仅通过战内升级获得。

| 属性名称 | 描述 | 初始值 | 获取/修改方式 |
| :------- | :--- | :---- | :-------------- |
| `tempDamageMult` (临时伤害乘数) | 仅本波次有效的额外伤害百分比加成。 | `0` | “战场支援”模态框的增益选项。 |
| `tempAttackSpeedMult` (临时攻速乘数) | 仅本波次有效的额外攻速百分比加成。 | `0` | “战场支援”模态框的增益选项。 |

### 3.5. 英雄专属属性 (Hero-Specific Attributes)

这些属性专门影响英雄单位，通过英雄升级或特定临时增益获得。

| 属性名称 | 描述 | 初始值 | 获取/修改方式 |
| :------- | :--- | :---- | :-------------- |
| `heroDamageMult` (英雄伤害乘数) | 英雄单位的独立伤害百分比乘数。 | `0` | 英雄升级，例如“英雄蛮力”路径，或“战场支援”模态框的英雄增益。 |
| `heroAttackSpeedMult` (英雄攻速乘数) | 英雄单位的独立攻击速度百分比乘数。 | `0` | 英雄升级，例如“神经加速”路径，或“战场支援”模态框的英雄增益。 |
| `heroEnergyGainRate` (英雄能量获取速率) | 英雄能量条充能速度的乘数。 | `1.0` | 英雄升级，或“战场支援”模态框的英雄增益。 |
| `heroMaxEnergy` (英雄最大能量) | 英雄能量条的最大值。 | `100` | 英雄升级，或“战场支援”模态框的英雄增益（目前道具未修改此项）。 |
| `ult_speed_mult` (大招攻速倍率) | 英雄终极技能期间的攻击速度倍率。 | `3` | 英雄升级（“终极技能”路径），初始3倍，升级后可达4倍。 |
| `ult_dmg_bonus` (大招伤害加成) | 英雄终极技能期间的额外伤害百分比加成。 | `0` | 英雄升级（“终极技能”路径）。 |
| `ult_kill_extend` (大招击杀延长) | 英雄终极技能期间，每次击杀敌人延长大招持续时间。 | `0` | 英雄升级（“终极技能”路径）。 |
| `ult_duration_bonus` (大招持续时间加成) | 英雄终极技能的基础持续时间加成。 | `0` | 英雄升级（“终极技能”路径）。 |

### 3.6. 特殊全局效果属性 (Special Global Effect Attributes)

这些属性通过道具的 `effect` 字段引入，并直接映射到 `PlayerStats`，用于触发特定的全局游戏逻辑。

| 属性名称 | 描述 | 初始值 (从道具获取) | 获取/修改方式 |
| :------- | :--- | :------------------ | :-------------- |
| `enemy_count` (敌人数量百分比) | 影响每波生成的敌人总数量的百分比。 | `0` | 道具 (`BrotatoItem`)，例如“友善的外星蛙”。 |

## 4. 计算公式引用

有关伤害、冷却时间、生命值等核心战斗数值的详细计算公式，请参阅 `docs/NUMERICAL_DESIGN.md` 文档。该文档会详细说明属性如何组合并影响最终的战斗表现。
